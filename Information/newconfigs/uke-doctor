#!/usr/bin/env bash
# Checks if UKE dependencies are installed and running

echo "üè• UKE v8 Doctor"
echo "================="

check() {
    if command -v "$1" &>/dev/null; then
        echo "‚úÖ $1 found"
    else
        echo "‚ùå $1 MISSING"
    fi
}

echo "Checking Core Tools..."
check "nvim"
check "tmux"
check "wezterm"
check "zsh"
check "stow"
check "jq"
check "fzf"
check "zoxide"

case "$(uname -s)" in
    Darwin)
        echo ""
        echo "Checking macOS Tools..."
        check "yabai"
        check "skhd"
        if pgrep -x "yabai" >/dev/null; then echo "‚úÖ yabai running"; else echo "‚ùå yabai STOPPED"; fi
        if pgrep -x "skhd" >/dev/null;  then echo "‚úÖ skhd running";  else echo "‚ùå skhd STOPPED"; fi
        ;;
    Linux)
        echo ""
        echo "Checking Linux Tools..."
        check "hyprctl"
        check "waybar"
        if pgrep -x "Hyprland" >/dev/null; then echo "‚úÖ Hyprland running"; else echo "‚ùå Hyprland STOPPED"; fi
        ;;
esac

echo ""
echo "Done."