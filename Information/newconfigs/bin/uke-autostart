#!/usr/bin/env bash
# ==============================================================================
# UKE Autostart (Linux/Hyprland)
# ==============================================================================
# Checks for Hyprland and starts it. Used in .zprofile
# ==============================================================================

if [[ "$(uname -s)" != "Linux" ]]; then exit 0; fi

# Guard: Don't run if Hyprland is already running
if pgrep -x "Hyprland" >/dev/null; then exit 0; fi

# Guard: Manual disable
if [[ -f "$HOME/.no-hyprland" ]]; then
    echo "Hyprland autostart disabled (~/.no-hyprland exists)."
    return 0 2>/dev/null || exit 0
fi

# TTY Check (Only auto-start on TTY1)
if [[ "$(tty)" == "/dev/tty1" ]]; then
    echo "Starting Hyprland..."
    
    # Environment Setup
    export XDG_CURRENT_DESKTOP=Hyprland
    export XDG_SESSION_TYPE=wayland
    export XDG_SESSION_DESKTOP=Hyprland
    
    # Exec
    exec Hyprland
fi
