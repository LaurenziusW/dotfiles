#!/usr/bin/env bash
# ==============================================================================
# UKE Logs - Live log viewer
# ==============================================================================
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
export UKE_ROOT="${SCRIPT_DIR%/bin}"

if [[ -f "$SCRIPT_DIR/../lib/core.sh" ]]; then
    source "$SCRIPT_DIR/../lib/core.sh"
else
    is_macos() { [[ "$(uname -s)" == "Darwin" ]]; }
fi

tail_log() {
    local name="$1" path="$2"
    [[ -f "$path" ]] || { echo "No log at $path"; return 1; }
    echo "Tailing $name: $path"
    tail -f "$path"
}

case "${1:-help}" in
    uke)      tail_log "UKE" "$HOME/.local/state/uke/uke.log" ;;
    yabai)    tail_log "yabai" "$(ls /tmp/yabai_*.err.log 2>/dev/null | head -1)" ;;
    skhd)     tail_log "skhd" "$(ls /tmp/skhd_*.err.log 2>/dev/null | head -1)" ;;
    hyprland) tail_log "Hyprland" "$HOME/.local/share/hyprland/hyprland.log" ;;
    *)        echo "Usage: uke-logs [uke|yabai|skhd|hyprland]" ;;
esac
