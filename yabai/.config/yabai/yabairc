#!/usr/bin/env sh
sudo yabai --load-sa
# ═══════════════════════════════════════════════════════════
# UNIFIED KEYBOARD ENVIRONMENT - Yabai Configuration
# (Using your layout, with "follow focus" and corrected rule order)
# ═══════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────
# Layout Configuration
# ───────────────────────────────────────────────────────────
yabai -m config layout bsp
yabai -m config top_padding 4
yabai -m config bottom_padding 4
yabai -m config left_padding 4
yabai -m config right_padding 4
yabai -m config window_gap 4



# ───────────────────────────────────────────────────────────
# Window Border Configuration (External Utility)
# ───────────────────────────────────────────────────────────
# Configure the 'borders' utility
borders width=3 \
        active_color=0xff88c0d0 \
        inactive_color=0xff3b4252 &

# ───────────────────────────────────────────────────────────
# Mouse Configuration
# ───────────────────────────────────────────────────────────
yabai -m config mouse_follows_focus off
yabai -m config focus_follows_mouse off
yabai -m config mouse_modifier alt
yabai -m config mouse_action1 move
yabai -m config mouse_action2 resize

# ───────────────────────────────────────────────────────────
# Window Behavior
# ───────────────────────────────────────────────────────────
yabai -m config split_ratio 0.50
yabai -m config auto_balance off
yabai -m config window_placement second_child

# ───────────────────────────────────────────────────────────
# Exclusions - Apps That Should Float
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^System Settings$" manage=off
yabai -m rule --add app="^Calculator$" manage=off
yabai -m rule --add app="^App Store$" manage=off

# ═══════════════════════════════════════════════════════════
# WORKSPACE (SPACE) APP ASSIGNMENTS
# ═══════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────
# Space 1: Browser & Web
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^Safari$" space=^1
yabai -m rule --add app="^Brave Browser$" space=^1
yabai -m rule --add app="^Raindrop.io$" space=^1

# ───────────────────────────────────────────────────────────
# Space 2: Notes & Writing
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^Obsidian$" space=^2

# ───────────────────────────────────────────────────────────
# Space 3: Terminal & Code Editors
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^WezTerm$" space=^3
yabai -m rule --add app="^Code$" space=^3
yabai -m rule --add app="^Xcode$" space=^3

# ───────────────────────────────────────────────────────────
# Space 4: ForkLift % Finder
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^Finder$" space=^4
yabai -m rule --add app="^ForkLift$" space=^4




# ───────────────────────────────────────────────────────────
# Space 5: PDF & Reading
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^Preview$" space=^5
yabai -m rule --add app="^PDF Expert$" space=^5

# ───────────────────────────────────────────────────────────
# Space 6: other
# ───────────────────────────────────────────────────────────



# ───────────────────────────────────────────────────────────
# Space 7: Media & Music
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^Spotify$" space=^7

# ───────────────────────────────────────────────────────────
# Space 8: Communication
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^Slack$" space=^8
yabai -m rule --add app="^Discord$" space=^8
yabai -m rule --add app="^Mail$" space=^8
yabai -m rule --add app="^Telegram$" space=^8

# ───────────────────────────────────────────────────────────
# Space 9: Office & Documents
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^Microsoft Word$" space=^9
yabai -m rule --add app="^Microsoft Excel$" space=^9
yabai -m rule --add app="^Microsoft PowerPoint$" space=^9


# ───────────────────────────────────────────────────────────
# Space 10: AI
# ───────────────────────────────────────────────────────────
yabai -m rule --add app="^Claude$" space=^10
yabai -m rule --add app="^Perplexity$" space=^10
yabai -m rule --add app="^GeminiAPP$" space=^10
yabai -m rule --add app="^PerplexityAPP$" space=^10
# ───────────────────────────────────────────────────────────
# Space 6: Everything else (Catch-all)
# ───────────────────────────────────────────────────────────
# This rule MUST be last. It catches all apps that
# did not match any rule above. '^' for focus.

yabai -m rule --add app!="^(GeminiAPP|Perplexity|PerplexityAPP|Claude|Safari|Brave Browser|Obsidian|WezTerm|Code|Xcode|Preview|PDF Expert|Raindrop.io|Spotify|Microsoft Word|Microsoft Excel|Microsoft PowerPoint|Slack|Discord|Mail|WhatsApp|Telegram|Finder|ForkLift)$" space=^6
yabai -m rule --add app="WhatsApp" role="AXWindow" space=^8



echo "yabai: Configuration loaded with workspace assignments"
