# =============================================================================
# UKE v8 - keyd Configuration
# Linux System-Level Key Remapping
# =============================================================================
# Install: sudo pacman -S keyd
# Enable:  sudo systemctl enable keyd && sudo systemctl start keyd
# Reload:  sudo keyd reload
# Copy:    sudo cp ~/.config/keyd/default.conf /etc/keyd/default.conf
# =============================================================================

[ids]
*

[main]
# Caps Lock as a modal "nav" layer + Escape on tap
capslock = overload(nav, esc)

# Optional: Swap Left Alt and Left Super for Mac keyboards on Linux
# leftalt = leftmeta
# leftmeta = leftalt

[nav]
# Vim-style navigation
h = left
j = down
k = up
l = right

# Page Navigation (Karabiner: u=PgDn, i=PgUp)
u = pagedown
i = pageup

# Line Navigation
y = home
z = home             # Karabiner: Cmd+Left (Start of Line)
o = end              # Karabiner: Cmd+Right (End of Line)

# Document Navigation
t = C-home           # Karabiner: Cmd+Up (Start of Doc)
g = C-end            # Karabiner: Cmd+Down (End of Doc)

# Word-wise movement (Karabiner: f/n=WordLeft, m=WordRight)
f = C-left
n = C-left
m = C-right

# Selection (Shift+Arrow) - WASD
w = S-up
a = S-left
s = S-down
d = S-right

# Word selection (Ctrl+Shift+Arrow)
q = C-S-left
e = C-S-right

# Delete operations
x = delete
backspace = delete   # Karabiner: Caps+Backspace -> Delete Forward

# Restore Caps Lock
' = capslock

# Escape hatch - just in case
escape = capslock

# Lock Keyboard (Alt + Escape) -> Swaps to locked layer
A-escape = swap(locked)

[compose:C]
# Example: compose + key = special character
e = é
a = ä
o = ö
u = ü
s = ß

# =============================================================================
# LOCKED STATE (Triple Escape to Unlock)
# =============================================================================

[locked]
# Block everything by default
* = noop
# First escape press -> move to stage 1
escape = swap(locked_1)

[locked_1]
# Any key other than escape resets to fully locked
* = swap(locked)
# Second escape press -> move to stage 2
escape = swap(locked_2)

[locked_2]
# Any key other than escape resets to fully locked
* = swap(locked)
# Third escape press -> unlock (swap back to main)
escape = swap(main)
